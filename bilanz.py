import streamlit as st
import pandas as pd
import altair as alt

st.set_page_config(
    page_title="Energieimporte und Importabhängigkeit",
    page_icon="chart_with_upwards_trend",
    )
    
# Your data (cleaned up the extra spaces and colons)
data = {
  "Jahr": ["2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020", "2021", "2022"],
  "Belgien": ["78.164", "80.693", "77.667", "79.704", "79.774", "79.912", "79.486", "76.882", "80.846", "75.921", "78.553", "76.464", "76.563", "77.777", "80.102", "84.145", "75.891", "75.258", "82.968", "77.591", "78.044", "70.824", "73.950"],
  "Bulgarien": ["46.409", "46.199", "46.917", "46.650", "48.340", "47.343", "46.223", "51.233", "52.154", "45.393", "40.146", "36.732", "36.859", "38.313", "35.171", "36.446", "38.472", "39.362", "36.596", "38.457", "38.171", "36.186", "37.132"],
  "Tschechien": ["22.704", "25.012", "26.204", "24.929", "25.338", "27.846", "27.498", "24.989", "27.736", "26.866", "25.379", "28.831", "25.413", "27.580", "30.227", "32.089", "32.800", "37.162", "36.879", "40.809", "38.767", "39.984", "41.793"],
  "Dänemark": ["-35.918", "-28.630", "-42.287", "-31.541", "-47.120", "-50.618", "-35.492", "-24.247", "-21.129", "-18.800", "-16.235", "-6.315", "-3.176", "12.312", "12.225", "13.077", "13.568", "11.343", "22.697", "38.868", "44.892", "32.297", "42.867"],
  "Deutschland": ["59.441", "60.891", "60.126", "60.540", "61.158", "60.740", "60.981", "58.516", "60.769", "61.103", "59.992", "61.801", "61.215", "62.411", "61.779", "62.132", "63.752", "63.959", "63.478", "67.055", "63.676", "63.395", "68.555"],
  "Estland": ["33.989", "33.742", "32.107", "29.764", "30.110", "26.878", "30.030", "24.288", "27.215", "27.175", "14.680", "13.646", "20.648", "14.522", "11.562", "11.182", "8.069", "4.584", "1.229", "4.724", "10.528", "1.412", "6.159"],
  "Irland": ["85.434", "89.605", "88.087", "90.265", "91.614", "89.656", "90.759", "87.563", "90.011", "87.821", "87.485", "90.352", "83.711", "91.551", "86.058", "88.711", "68.991", "66.053", "67.605", "68.691", "71.078", "76.991", "79.155"],
  "Griechenland": ["69.055", "68.495", "71.063", "67.088", "72.259", "68.204", "71.419", "70.858", "72.915", "67.341", "68.584", "64.677", "65.889", "61.750", "65.455", "71.047", "72.911", "71.282", "70.681", "74.103", "81.415", "73.819", "79.601"],
  "Spanien": ["76.797", "74.797", "78.642", "76.738", "77.652", "81.534", "81.304", "79.560", "81.605", "79.549", "77.003", "76.012", "72.798", "69.997", "72.557", "72.741", "71.486", "73.886", "73.613", "75.034", "67.892", "69.471", "74.347"],
  "Frankreich": ["51.275", "50.429", "50.817", "50.665", "50.860", "51.698", "51.518", "50.420", "50.748", "50.652", "48.668", "49.039", "48.174", "47.987", "46.212", "45.894", "47.340", "48.743", "46.793", "47.480", "44.389", "44.106", "51.917"],
  "Kroatien": ["48.345", "46.556", "54.450", "50.697", "51.876", "52.595", "49.170", "51.805", "54.755", "46.044", "46.696", "49.641", "49.847", "47.436", "44.206", "48.791", "48.430", "53.157", "52.695", "56.216", "53.564", "54.539", "60.303"],
  "Italien": ["86.523", "83.244", "85.589", "82.995", "84.360", "83.348", "85.867", "83.002", "82.804", "80.777", "82.571", "81.353", "79.109", "76.736", "75.811", "77.030", "77.653", "76.979", "76.338", "77.484", "73.454", "73.348", "79.165"],
  "Zypern": ["98.632", "96.075", "100.557", "96.074", "95.457", "100.703", "102.508", "95.894", "97.427", "96.130", "100.636", "92.263", "96.748", "96.071", "93.086", "97.319", "95.841", "95.927", "92.491", "92.792", "93.179", "89.524", "92.018"],
  "Lettland": ["61.010", "59.372", "58.760", "63.235", "69.422", "63.841", "66.707", "62.478", "58.825", "60.411", "45.545", "59.863", "56.388", "55.883", "40.592", "51.179", "47.152", "44.053", "44.313", "43.913", "45.481", "38.333", "38.747"],
  "Litauen": ["57.776", "45.539", "40.610", "42.663", "45.521", "55.332", "60.351", "59.111", "56.016", "48.045", "79.045", "78.604", "77.534", "75.556", "74.935", "75.452", "74.784", "71.965", "73.897", "75.202", "74.909", "73.272", "72.434"],
  "Luxemburg": ["99.598", "97.374", "98.610", "98.378", "97.892", "97.376", "98.232", "96.668", "97.446", "97.514", "97.069", "97.293", "97.510", "97.100", "96.626", "95.958", "96.280", "95.558", "95.153", "95.006", "92.331", "92.437", "91.317"],
  "Ungarn": ["54.978", "53.411", "56.885", "62.057", "60.955", "62.254", "61.819", "60.362", "62.589", "57.574", "56.930", "50.273", "50.146", "50.122", "59.845", "53.875", "55.823", "62.645", "58.123", "69.712", "56.618", "54.121", "64.183"],
  "Malta": ["100.246", "99.822", "99.802", "99.826", "99.829", "99.967", "99.962", "99.956", "99.952", "99.926", "99.036", "101.300", "100.973", "104.139", "97.657", "97.296", "101.076", "103.052", "97.527", "97.274", "97.555", "97.086", "99.009"],
  "Niederlande": ["38.267", "34.403", "35.084", "38.717", "32.149", "37.784", "38.561", "37.407", "33.555", "34.059", "28.279", "29.357", "30.635", "23.738", "30.948", "43.635", "43.870", "48.548", "54.346", "64.376", "68.142", "58.404", "80.266"],
  "Österreich": ["65.543", "65.044", "68.022", "70.993", "71.451", "71.760", "72.248", "68.475", "68.738", "65.122", "62.782", "69.981", "63.785", "61.260", "65.625", "60.379", "62.102", "63.930", "64.223", "71.601", "58.420", "51.841", "74.454"],
  "Polen": ["10.722", "10.450", "11.439", "13.309", "14.727", "17.748", "20.149", "25.790", "30.862", "32.041", "31.569", "34.020", "31.628", "26.254", "29.415", "29.848", "30.760", "38.269", "43.505", "45.237", "42.768", "40.459", "46.029"],
  "Portugal": ["85.286", "85.177", "84.162", "85.488", "83.933", "88.561", "83.967", "81.519", "83.623", "81.434", "75.220", "77.792", "79.461", "73.347", "70.234", "76.293", "72.241", "77.965", "75.657", "73.875", "65.282", "66.925", "71.274"],
  "Rumänien": ["21.884", "26.272", "24.275", "25.418", "30.036", "27.474", "29.158", "31.460", "27.650", "19.890", "21.386", "21.140", "22.463", "18.317", "16.663", "16.687", "21.901", "23.295", "24.291", "30.282", "28.191", "31.649", "32.412"],
  "Slowenien": ["51.852", "48.940", "49.749", "52.467", "51.379", "50.826", "50.897", "50.821", "53.587", "48.834", "49.277", "48.329", "51.813", "47.461", "45.187", "49.304", "49.017", "50.769", "51.213", "52.116", "45.681", "48.615", "53.966"],
  "Slowakei": ["65.065", "62.537", "64.476", "64.918", "68.180", "65.990", "64.344", "69.736", "65.842", "67.692", "61.942", "63.462", "58.952", "58.400", "60.698", "58.013", "58.206", "62.541", "61.905", "69.785", "56.329", "52.584", "69.630"],
  "Finnland": ["55.475", "55.337", "52.360", "59.095", "54.731", "54.459", "54.073", "53.320", "54.483", "54.795", "48.859", "53.914", "47.109", "49.662", "49.935", "47.946", "46.161", "43.939", "45.341", "43.017", "43.156", "37.980", "40.884"],
  "Schweden": ["39.316", "37.005", "37.664", "43.679", "37.256", "38.075", "38.227", "36.797", "38.416", "38.186", "37.990", "36.476", "30.164", "32.790", "32.335", "30.061", "33.301", "26.658", "29.062", "30.044", "31.968", "21.217", "26.824"]
}


df = pd.DataFrame(data)

# Melt the DataFrame to long format for Altair
df_melted = df.melt(id_vars='Jahr', var_name='Country', value_name='Value')

# Convert 'Value' column to numeric
df_melted['Value'] = pd.to_numeric(df_melted['Value'])

# Streamlit app
st.title(':material/oil_barrel: Energieimporte und Importabhängigkeit')
st.markdown('Prozentualer Anteil der Nettoeinfuhren an der verfügbaren Bruttoenergie (basierend auf Terajoule) im Vergleich für den Zeitraum 2000 bis 2022:')

# Auswahl der Länder
selected_countries = st.multiselect(
    'Wähle Länder aus:', 
    df_melted['Country'].unique(), 
    default=['Deutschland']
)

# Filter die Daten basierend auf der Auswahl
filtered_df = df_melted[df_melted['Country'].isin(selected_countries)]

# Create the Altair chart
chart = alt.Chart(filtered_df).mark_line(point=True).encode(
    x='Jahr',
    y=alt.Y('Value', title='Prozentualer Anteil'),
    color='Country',
    tooltip=['Jahr', 'Country', 'Value']
).properties(
    title='Abhängigkeit von Energieimporten - gesamt',
).interactive()

container = st.container(border=True)

container.altair_chart(chart, use_container_width=True)

st.markdown('Die EU ist in hohem Maße von Energieimporten abhängig, insbesondere von fossilen Brennstoffen. Die Abhängigkeit von Russland als Energielieferant ist ein Risikofaktor, der durch den Krieg in der Ukraine deutlich wurde. Die EU-Länder weisen unterschiedliche Abhängigkeiten auf, wobei einige Länder fast vollständig auf Importe angewiesen sind.')#
st.markdown('Im Zeitraum zwischen 2000 und 2022 sind die Abhängigkeiten vieler Länder noch stärker gestiegen.')

with st.expander("Quellen"):
    st.link_button('Eurostat',"https://ec.europa.eu/eurostat/de/web/interactive-publications/energy-2024")
    st.link_button('Eurostat',"https://ec.europa.eu/eurostat/databrowser/view/NRG_IND_ID__custom_9228975/bookmark/table?lang=de&bookmarkId=2723b1ac-47ba-40a8-9944-05b44bb40ebd")
    st.link_button("Statistisches Bundesamt","https://www.destatis.de/Europa/DE/Thema/Umwelt-Energie/Energieabhaengigkeit.html#:~:text=Deutschland%20ist%20auf%20Energieimporte%20aus,H%C3%A4lfte%20ihres%20Energiebedarfs%20aus%20Einfuhren.")